## 1.用蓝莲花完成cookie获取

### 使用docker拉取镜像

```bash
sudo docker pull romeoz/docker-apache-php:5.6
```

![](http://bex-image.oss-cn-hangzhou.aliyuncs.com/img/image-20221118141038487.png)

### 创建容器并运行

```bash
sudo docker run -d -p 8888:80 --name PHP5.6 romeoz/docker-apache-php:5.6
```

![image-20221118141310010](http://bex-image.oss-cn-hangzhou.aliyuncs.com/img/image-20221118141310010.png)

### 将BlueLotus_XSSReceiver拷贝到容器中

```bash
sudo docker cp BlueLotus_XSSReceiver 容器ID:/var/www/app
```

![image-20221118141400056](http://bex-image.oss-cn-hangzhou.aliyuncs.com/img/image-20221118141400056.png)

### 进入容器中删除默认index文件，然后将BlueLotus_XSSReceiver内容移到该目录下并删除空文件夹，最后修改配置

在kali下用此命令进入容器

```bash
sudo docker exec -it 容器ID /bin/bash
```

在容器中执行以下命令

```bash
rm -rf index.php
mv BlueLotus_XSSReceiver/* .
rm -rf BlueLotus_XSSReceiver/
chmod -R 777 myjs
chmod -R 777 data
chmod -R 777 ./
```

### 访问BlueLotus_XSSReceiver后台

`http://docker宿主机ip:8888/admin.php`

![image-20221118142903280](http://bex-image.oss-cn-hangzhou.aliyuncs.com/img/image-20221118142903280.png)

进行配置，全部默认

![image-20221118143033486](http://bex-image.oss-cn-hangzhou.aliyuncs.com/img/image-20221118143033486.png)

### 将公共模板中的default.js复制到我的JS下写入地址和端口后生成payload

![image-20221118154426957](http://bex-image.oss-cn-hangzhou.aliyuncs.com/img/image-20221118154426957.png)

![image-20221118154440034](http://bex-image.oss-cn-hangzhou.aliyuncs.com/img/image-20221118154440034.png)

### 然后将payload注入网站

![image-20221118154521737](http://bex-image.oss-cn-hangzhou.aliyuncs.com/img/image-20221118154521737.png)

### 其他用户打开后即可得到cookie



![](http://bex-image.oss-cn-hangzhou.aliyuncs.com/img/image-20221118154309949.png)

## 2.完成Flash钓鱼

### 将flash文件放置在docker下

```bash
sudo docker cp flash 28f68:/var/www/app
```

![image-20221118201016532](http://bex-image.oss-cn-hangzhou.aliyuncs.com/img/image-20221118201016532.png)

### 修改JS文件为自己的flash地址并放入蓝莲花

![image-20221118201226975](http://bex-image.oss-cn-hangzhou.aliyuncs.com/img/image-20221118201226975.png)

### 将payload插入有xss漏洞处

![image-20221118201704403](http://bex-image.oss-cn-hangzhou.aliyuncs.com/img/image-20221118201704403.png)

### 成功钓鱼

![image-20221118201722141](http://bex-image.oss-cn-hangzhou.aliyuncs.com/img/image-20221118201722141.png)

![image-20221118201734401](http://bex-image.oss-cn-hangzhou.aliyuncs.com/img/image-20221118201734401.png)

## 3.完成cobalt strike钓鱼，获取用户名和密码

### 配置JDK环境

```bash
sudo apt install openjdk-11-jdk
```

![image-20221118154918763](http://bex-image.oss-cn-hangzhou.aliyuncs.com/img/image-20221118154918763.png)

### 解压CS并启动服务端

```bash
unzip -d CS cs4.4-jdk11.zip
```

```bash
chmod +x teamserver
sudo ./teamserver ip地址 密码
```

![image-20221118155334215](http://bex-image.oss-cn-hangzhou.aliyuncs.com/img/image-20221118155334215.png)

![image-20221118155318849](http://bex-image.oss-cn-hangzhou.aliyuncs.com/img/image-20221118155318849.png)

### 启动客户端

```
chmod +x cobaltstrike
./cobaltstrike
```

![](http://bex-image.oss-cn-hangzhou.aliyuncs.com/img/image-20221118155940359.png)

### 选择攻击 -> 钓鱼攻击 -> 克隆网站

![image-20221118160231705](http://bex-image.oss-cn-hangzhou.aliyuncs.com/img/image-20221118160231705.png)

### 克隆成功

![image-20221118160352072](http://bex-image.oss-cn-hangzhou.aliyuncs.com/img/image-20221118160352072.png)

### 在蓝莲花中创建JS代码

![image-20221118161554709](http://bex-image.oss-cn-hangzhou.aliyuncs.com/img/image-20221118161554709.png)

### 在原本的页面利用XSS漏洞插入代码，引诱用户进入钓鱼网站

![image-20221118161656897](http://bex-image.oss-cn-hangzhou.aliyuncs.com/img/image-20221118161656897.png)

![image-20221118161718368](http://bex-image.oss-cn-hangzhou.aliyuncs.com/img/image-20221118161718368.png)

### 用户在钓鱼页面中输入网站即可在CS中获取账户密码

![image-20221118162321906](http://bex-image.oss-cn-hangzhou.aliyuncs.com/img/image-20221118162321906.png)

